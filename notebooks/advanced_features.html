<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Advanced features &mdash; BipartitePandas 1.1.9 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Python API" href="../internal.html" />
    <link rel="prev" title="Connected sets" href="connected_sets.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> BipartitePandas
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doc-python.html">From Python</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Notebook examples</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="simple_example.html">Simple Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="formats.html">Formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="custom_columns.html">Custom Columns</a></li>
<li class="toctree-l1"><a class="reference internal" href="clustering.html">Clustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="connected_sets.html">Connected Sets</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Advanced Features</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Import-the-BipartitePandas-package">Import the BipartitePandas package</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Get-your-data-ready">Get your data ready</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Advanced-data-cleaning">Advanced data cleaning</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Set-how-to-handle-worker-year-duplicates">Set how to handle worker-year duplicates</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Collapse-at-the-match-level">Collapse at the match-level</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Avoid-unnecessary-copies">Avoid unnecessary copies</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Avoid-unnecessary-sorts">Avoid unnecessary sorts</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Avoid-complicated-loops">Avoid complicated loops</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Advanced-clustering">Advanced clustering</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Install-Intel(R)-Extension-for-Scikit-learn">Install Intel(R) Extension for Scikit-learn</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Advanced-dataframe-handling">Advanced dataframe handling</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Disable-logging">Disable logging</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Use-method-chaining-with-in-place-operations">Use method chaining with in-place operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Understand-the-difference-between-general-columns-and-subcolumns">Understand the difference between general columns and subcolumns</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Bypass-restrictions">Bypass restrictions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Simpler-constructor">Simpler constructor</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Restore-original-ids">Restore original ids</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Retrieve-and-update-custom-column-properties">Retrieve and update custom column properties</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Compare-dataframes">Compare dataframes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Fill-in-missing-periods-as-unemployed">Fill in missing periods as unemployed</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Extended-event-studies">Extended event studies</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Advanced-data-simulation">Advanced data simulation</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Under the hood</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../internal.html">Python API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../class-bipartitedataframe.html">BipartiteDataFrame</a></li>
<li class="toctree-l1"><a class="reference internal" href="../class-bipartitebase.html">BipartiteBase</a></li>
<li class="toctree-l1"><a class="reference internal" href="../class-bipartitelongbase.html">BipartiteLongBase</a></li>
<li class="toctree-l1"><a class="reference internal" href="../class-bipartitelong.html">BipartiteLong</a></li>
<li class="toctree-l1"><a class="reference internal" href="../class-bipartitelongcollapsed.html">BipartiteLongCollapsed</a></li>
<li class="toctree-l1"><a class="reference internal" href="../class-bipartiteeventstudybase.html">BipartiteEventStudyBase</a></li>
<li class="toctree-l1"><a class="reference internal" href="../class-bipartiteeventstudy.html">BipartiteEventStudy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../class-bipartiteeventstudycollapsed.html">BipartiteEventStudyCollapsed</a></li>
<li class="toctree-l1"><a class="reference internal" href="../class-bipartiteextendedeventstudybase.html">BipartiteExtendedEventStudyBase</a></li>
<li class="toctree-l1"><a class="reference internal" href="../class-bipartiteextendedeventstudy.html">BipartiteExtendedEventStudy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../class-bipartiteextendedeventstudycollapsed.html">BipartiteExtendedEventStudyCollapsed</a></li>
<li class="toctree-l1"><a class="reference internal" href="../class-simbipartite.html">SimBipartite</a></li>
<li class="toctree-l1"><a class="reference internal" href="../module-measures.html">Measures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../module-grouping.html">Grouping</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">BipartitePandas</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Advanced features</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/notebooks/advanced_features.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
.jp-RenderedHTMLCommon table,
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
.jp-RenderedHTMLCommon thead,
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
.jp-RenderedHTMLCommon tr,
.jp-RenderedHTMLCommon th,
.jp-RenderedHTMLCommon td,
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
.jp-RenderedHTMLCommon th,
div.rendered_html th {
  font-weight: bold;
}
.jp-RenderedHTMLCommon tbody tr:nth-child(odd),
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.jp-RenderedHTMLCommon tbody tr:hover,
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="Advanced-features">
<h1>Advanced features<a class="headerlink" href="#Advanced-features" title="Permalink to this heading"></a></h1>
<section id="Import-the-BipartitePandas-package">
<h2>Import the BipartitePandas package<a class="headerlink" href="#Import-the-BipartitePandas-package" title="Permalink to this heading"></a></h2>
<p>Make sure to install it using <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">bipartitepandas</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">bipartitepandas</span> <span class="k">as</span> <span class="nn">bpd</span>
</pre></div>
</div>
</div>
</section>
<section id="Get-your-data-ready">
<h2>Get your data ready<a class="headerlink" href="#Get-your-data-ready" title="Permalink to this heading"></a></h2>
<p>For this notebook, we simulate data.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">bpd</span><span class="o">.</span><span class="n">SimBipartite</span><span class="p">()</span><span class="o">.</span><span class="n">simulate</span><span class="p">()</span>
<span class="n">bdf</span> <span class="o">=</span> <span class="n">bpd</span><span class="o">.</span><span class="n">BipartiteDataFrame</span><span class="p">(</span>
    <span class="n">i</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;i&#39;</span><span class="p">],</span> <span class="n">j</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;j&#39;</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">t</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">bdf</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>i</th>
      <th>j</th>
      <th>y</th>
      <th>t</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>66</td>
      <td>-0.884222</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>49</td>
      <td>-2.224977</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>49</td>
      <td>-1.711429</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>115</td>
      <td>-0.082440</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>6</td>
      <td>-1.190540</td>
      <td>4</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>49995</th>
      <td>9999</td>
      <td>146</td>
      <td>0.505200</td>
      <td>0</td>
    </tr>
    <tr>
      <th>49996</th>
      <td>9999</td>
      <td>114</td>
      <td>-0.095290</td>
      <td>1</td>
    </tr>
    <tr>
      <th>49997</th>
      <td>9999</td>
      <td>114</td>
      <td>-1.240715</td>
      <td>2</td>
    </tr>
    <tr>
      <th>49998</th>
      <td>9999</td>
      <td>114</td>
      <td>0.701339</td>
      <td>3</td>
    </tr>
    <tr>
      <th>49999</th>
      <td>9999</td>
      <td>114</td>
      <td>-0.610246</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
<p>50000 rows × 4 columns</p>
</div></div>
</div>
</section>
<section id="Advanced-data-cleaning">
<h2>Advanced data cleaning<a class="headerlink" href="#Advanced-data-cleaning" title="Permalink to this heading"></a></h2>
<div class="admonition note">
<p class="admonition-title fa fa-exclamation-circle">Hint</p>
<p>Want details on all cleaning parameters? Run <code class="docutils literal notranslate"><span class="pre">bpd.clean_params().describe_all()</span></code>, or search through <code class="docutils literal notranslate"><span class="pre">bpd.clean_params().keys()</span></code> for a particular key, and then run <code class="docutils literal notranslate"><span class="pre">bpd.clean_params().describe(key)</span></code>.</p>
</div>
<section id="Set-how-to-handle-worker-year-duplicates">
<h3>Set how to handle worker-year duplicates<a class="headerlink" href="#Set-how-to-handle-worker-year-duplicates" title="Permalink to this heading"></a></h3>
<p>Use the parameter <code class="docutils literal notranslate"><span class="pre">i_t_how</span></code> to customize how worker-year duplicates are handled.</p>
</section>
<section id="Collapse-at-the-match-level">
<h3>Collapse at the match-level<a class="headerlink" href="#Collapse-at-the-match-level" title="Permalink to this heading"></a></h3>
<p>If you drop the <code class="docutils literal notranslate"><span class="pre">t</span></code> column, collapsing will automatically collapse at the match level. However, this prevents conversion to event study format (this can be bypassed with the <code class="docutils literal notranslate"><span class="pre">.construct_artificial_time()</span></code> method, but the data will likely have a meaningless order, rendering the event study uninterpretable).</p>
</section>
<section id="Avoid-unnecessary-copies">
<h3>Avoid unnecessary copies<a class="headerlink" href="#Avoid-unnecessary-copies" title="Permalink to this heading"></a></h3>
<p>If you are working with a large dataset, you will want to avoid copies whenever possible. So set <code class="docutils literal notranslate"><span class="pre">copy=False</span></code>.</p>
</section>
<section id="Avoid-unnecessary-sorts">
<h3>Avoid unnecessary sorts<a class="headerlink" href="#Avoid-unnecessary-sorts" title="Permalink to this heading"></a></h3>
<p>If you know your data is sorted by <code class="docutils literal notranslate"><span class="pre">i</span></code> and <code class="docutils literal notranslate"><span class="pre">t</span></code> (or, if you aren’t including a <code class="docutils literal notranslate"><span class="pre">t</span></code> column, just by <code class="docutils literal notranslate"><span class="pre">i</span></code>), then set <code class="docutils literal notranslate"><span class="pre">is_sorted=True</span></code>.</p>
</section>
<section id="Avoid-complicated-loops">
<h3>Avoid complicated loops<a class="headerlink" href="#Avoid-complicated-loops" title="Permalink to this heading"></a></h3>
<p>Sometimes workers leave a firm, then return to it (we call these workers <em>returners</em>). Returners can cause computational difficulties because sometimes intermediate firms get dropped (e.g. a worker goes from firm <span class="math notranslate nohighlight">\(A \to B \to A\)</span>, but firm <span class="math notranslate nohighlight">\(B\)</span> gets dropped). This turns returners into stayers. This can change the largest connected set of firms, and if data is in collapsed format, requires the data to be recollapsed.</p>
<p>Because of these potential complications, if there are returners, many methods require loops that run until convergence.</p>
<p>These difficulties can be avoided by setting the parameter <code class="docutils literal notranslate"><span class="pre">drop_returns</span></code> (there are multiple ways to handle returners, they can be seen by running <code class="docutils literal notranslate"><span class="pre">bpd.clean_params().describe('drop_returns')</span></code>).</p>
<div class="admonition note">
<p class="admonition-title fa fa-exclamation-circle">Alternative</p>
<p>Another way to handle returners is to drop the <code class="docutils literal notranslate"><span class="pre">t</span></code> column. Then, sorting will automatically sort by <code class="docutils literal notranslate"><span class="pre">i</span></code> and <code class="docutils literal notranslate"><span class="pre">j</span></code>, which eliminates the possibility of returners. However, this prevents conversion to event study format (this can be bypassed with the <code class="docutils literal notranslate"><span class="pre">.construct_artificial_time()</span></code> method, but the data will likely have a meaningless order, rendering the event study uninterpretable).</p>
</div>
</section>
</section>
<section id="Advanced-clustering">
<h2>Advanced clustering<a class="headerlink" href="#Advanced-clustering" title="Permalink to this heading"></a></h2>
<section id="Install-Intel(R)-Extension-for-Scikit-learn">
<h3>Install Intel(R) Extension for Scikit-learn<a class="headerlink" href="#Install-Intel(R)-Extension-for-Scikit-learn" title="Permalink to this heading"></a></h3>
<p>Intel(R) Extension for Scikit-learn (<a class="reference external" href="https://github.com/intel/scikit-learn-intelex">GitHub</a>) can speed up KMeans clustering.</p>
</section>
</section>
<section id="Advanced-dataframe-handling">
<h2>Advanced dataframe handling<a class="headerlink" href="#Advanced-dataframe-handling" title="Permalink to this heading"></a></h2>
<section id="Disable-logging">
<h3>Disable logging<a class="headerlink" href="#Disable-logging" title="Permalink to this heading"></a></h3>
<p>Logging can slow down basic operations on BipartitePandas dataframes (e.g. data cleaning). Set the parameter <code class="docutils literal notranslate"><span class="pre">log=False</span></code> when constructing your dataframe to turn off logging.</p>
</section>
<section id="Use-method-chaining-with-in-place-operations">
<h3>Use method chaining with in-place operations<a class="headerlink" href="#Use-method-chaining-with-in-place-operations" title="Permalink to this heading"></a></h3>
<p>Unlike standard Pandas, BipartitePandas allows method chaining with in-place operations.</p>
</section>
<section id="Understand-the-difference-between-general-columns-and-subcolumns">
<h3>Understand the difference between general columns and subcolumns<a class="headerlink" href="#Understand-the-difference-between-general-columns-and-subcolumns" title="Permalink to this heading"></a></h3>
<p>Users interact with general columns, while BipartitePandas dataframes display subcolumns. As an example, for event study format, the columns for firm clusters are labeled <code class="docutils literal notranslate"><span class="pre">g1</span></code> and <code class="docutils literal notranslate"><span class="pre">g2</span></code>. These are the subcolumns for general column <code class="docutils literal notranslate"><span class="pre">g</span></code>. If you want to drop firm clusters from the dataframe, rather than dropping <code class="docutils literal notranslate"><span class="pre">g1</span></code> and <code class="docutils literal notranslate"><span class="pre">g2</span></code> separately, you must drop the general column <code class="docutils literal notranslate"><span class="pre">g</span></code>. This paradigm applies throughout BipartitePandas and the documentation will make clear when you should specify
general columns.</p>
</section>
<section id="Bypass-restrictions">
<h3>Bypass restrictions<a class="headerlink" href="#Bypass-restrictions" title="Permalink to this heading"></a></h3>
<p>Sometimes BipartitePandas imposes restrictions that you may want to bypass. While BipartitePandas does not provide an explicit way to disable these restrictions, you can bypass them by converting your data into a Pandas dataframe, running the code that was formerly restricted, then converting it back into a BipartitePandas dataframe.</p>
</section>
<section id="Simpler-constructor">
<h3>Simpler constructor<a class="headerlink" href="#Simpler-constructor" title="Permalink to this heading"></a></h3>
<p>If the columns in your Pandas dataframe are already named correctly, you can simply put the dataframe as a parameter into the BipartitePandas dataframe constructor. Here is an example:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bdf</span> <span class="o">=</span> <span class="n">bpd</span><span class="o">.</span><span class="n">BipartiteDataFrame</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">clean</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">bdf</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
checking required columns and datatypes
sorting rows
dropping NaN observations
generating &#39;m&#39; column
keeping highest paying job for i-t (worker-year) duplicates (how=&#39;max&#39;)
dropping workers who leave a firm then return to it (how=False)
making &#39;i&#39; ids contiguous
making &#39;j&#39; ids contiguous
computing largest connected set (how=None)
sorting columns
resetting index
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>i</th>
      <th>j</th>
      <th>y</th>
      <th>t</th>
      <th>m</th>
      <th>alpha</th>
      <th>k</th>
      <th>l</th>
      <th>psi</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>66</td>
      <td>-0.884222</td>
      <td>0</td>
      <td>1</td>
      <td>-0.967422</td>
      <td>3</td>
      <td>0</td>
      <td>-0.348756</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>49</td>
      <td>-2.224977</td>
      <td>1</td>
      <td>1</td>
      <td>-0.967422</td>
      <td>2</td>
      <td>0</td>
      <td>-0.604585</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>49</td>
      <td>-1.711429</td>
      <td>2</td>
      <td>1</td>
      <td>-0.967422</td>
      <td>2</td>
      <td>0</td>
      <td>-0.604585</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>115</td>
      <td>-0.082440</td>
      <td>3</td>
      <td>2</td>
      <td>-0.967422</td>
      <td>5</td>
      <td>0</td>
      <td>0.114185</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>6</td>
      <td>-1.190540</td>
      <td>4</td>
      <td>1</td>
      <td>-0.967422</td>
      <td>0</td>
      <td>0</td>
      <td>-1.335178</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>49995</th>
      <td>9999</td>
      <td>146</td>
      <td>0.505200</td>
      <td>0</td>
      <td>1</td>
      <td>0.000000</td>
      <td>7</td>
      <td>2</td>
      <td>0.604585</td>
    </tr>
    <tr>
      <th>49996</th>
      <td>9999</td>
      <td>114</td>
      <td>-0.095290</td>
      <td>1</td>
      <td>1</td>
      <td>0.000000</td>
      <td>5</td>
      <td>2</td>
      <td>0.114185</td>
    </tr>
    <tr>
      <th>49997</th>
      <td>9999</td>
      <td>114</td>
      <td>-1.240715</td>
      <td>2</td>
      <td>0</td>
      <td>0.000000</td>
      <td>5</td>
      <td>2</td>
      <td>0.114185</td>
    </tr>
    <tr>
      <th>49998</th>
      <td>9999</td>
      <td>114</td>
      <td>0.701339</td>
      <td>3</td>
      <td>0</td>
      <td>0.000000</td>
      <td>5</td>
      <td>2</td>
      <td>0.114185</td>
    </tr>
    <tr>
      <th>49999</th>
      <td>9999</td>
      <td>114</td>
      <td>-0.610246</td>
      <td>4</td>
      <td>0</td>
      <td>0.000000</td>
      <td>5</td>
      <td>2</td>
      <td>0.114185</td>
    </tr>
  </tbody>
</table>
<p>50000 rows × 9 columns</p>
</div></div>
</div>
</section>
</section>
<section id="Restore-original-ids">
<h2>Restore original ids<a class="headerlink" href="#Restore-original-ids" title="Permalink to this heading"></a></h2>
<p>To restore original ids, we need to make sure the dataframe is tracking ids as they change.</p>
<p>We make sure the dataframe tracks ids as they change by setting <code class="docutils literal notranslate"><span class="pre">track_id_changes=True</span></code>.</p>
<p>Notice that in this example we use <code class="docutils literal notranslate"><span class="pre">j</span> <span class="pre">/</span> <span class="pre">2</span></code>, so that <code class="docutils literal notranslate"><span class="pre">j</span></code> will be modified during data cleaning.</p>
<p>The method <code class="docutils literal notranslate"><span class="pre">.original_ids()</span></code> will then return a dataframe that merges in the original ids.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bdf_original_ids</span> <span class="o">=</span> <span class="n">bpd</span><span class="o">.</span><span class="n">BipartiteDataFrame</span><span class="p">(</span>
    <span class="n">i</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;i&#39;</span><span class="p">],</span> <span class="n">j</span><span class="o">=</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;j&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">t</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">],</span>
    <span class="n">track_id_changes</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span><span class="o">.</span><span class="n">clean</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">bdf_original_ids</span><span class="o">.</span><span class="n">original_ids</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
checking required columns and datatypes
sorting rows
dropping NaN observations
generating &#39;m&#39; column
keeping highest paying job for i-t (worker-year) duplicates (how=&#39;max&#39;)
dropping workers who leave a firm then return to it (how=False)
making &#39;i&#39; ids contiguous
making &#39;j&#39; ids contiguous
computing largest connected set (how=None)
sorting columns
resetting index
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>i</th>
      <th>j</th>
      <th>y</th>
      <th>t</th>
      <th>m</th>
      <th>original_j</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>-0.884222</td>
      <td>0</td>
      <td>1</td>
      <td>33.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>1</td>
      <td>-2.224977</td>
      <td>1</td>
      <td>1</td>
      <td>24.5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>1</td>
      <td>-1.711429</td>
      <td>2</td>
      <td>1</td>
      <td>24.5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>2</td>
      <td>-0.082440</td>
      <td>3</td>
      <td>2</td>
      <td>57.5</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>3</td>
      <td>-1.190540</td>
      <td>4</td>
      <td>1</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>49995</th>
      <td>9999</td>
      <td>109</td>
      <td>0.505200</td>
      <td>0</td>
      <td>1</td>
      <td>73.0</td>
    </tr>
    <tr>
      <th>49996</th>
      <td>9999</td>
      <td>28</td>
      <td>-0.095290</td>
      <td>1</td>
      <td>1</td>
      <td>57.0</td>
    </tr>
    <tr>
      <th>49997</th>
      <td>9999</td>
      <td>28</td>
      <td>-1.240715</td>
      <td>2</td>
      <td>0</td>
      <td>57.0</td>
    </tr>
    <tr>
      <th>49998</th>
      <td>9999</td>
      <td>28</td>
      <td>0.701339</td>
      <td>3</td>
      <td>0</td>
      <td>57.0</td>
    </tr>
    <tr>
      <th>49999</th>
      <td>9999</td>
      <td>28</td>
      <td>-0.610246</td>
      <td>4</td>
      <td>0</td>
      <td>57.0</td>
    </tr>
  </tbody>
</table>
<p>50000 rows × 6 columns</p>
</div></div>
</div>
</section>
<section id="Retrieve-and-update-custom-column-properties">
<h2>Retrieve and update custom column properties<a class="headerlink" href="#Retrieve-and-update-custom-column-properties" title="Permalink to this heading"></a></h2>
<p>Custom column properties can be retrived with the method <code class="docutils literal notranslate"><span class="pre">.get_column_properties()</span></code> and updated with the method <code class="docutils literal notranslate"><span class="pre">.set_column_properties()</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">bdf</span><span class="o">.</span><span class="n">get_column_properties</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">))</span>
<span class="n">bdf</span> <span class="o">=</span> <span class="n">bdf</span><span class="o">.</span><span class="n">set_column_properties</span><span class="p">(</span>
    <span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="n">is_categorical</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;categorical&#39;</span>
<span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">bdf</span><span class="o">.</span><span class="n">get_column_properties</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;general_column&#39;: &#39;alpha&#39;,
 &#39;subcolumns&#39;: &#39;alpha&#39;,
 &#39;dtype&#39;: &#39;float&#39;,
 &#39;is_categorical&#39;: False,
 &#39;how_collapse&#39;: &#39;mean&#39;,
 &#39;long_es_split&#39;: True}
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;general_column&#39;: &#39;alpha&#39;,
 &#39;subcolumns&#39;: &#39;alpha&#39;,
 &#39;dtype&#39;: &#39;categorical&#39;,
 &#39;is_categorical&#39;: True,
 &#39;how_collapse&#39;: &#39;first&#39;,
 &#39;long_es_split&#39;: True}
</pre></div></div>
</div>
</section>
<section id="Compare-dataframes">
<h2>Compare dataframes<a class="headerlink" href="#Compare-dataframes" title="Permalink to this heading"></a></h2>
<p>Dataframes can be compared using the utility function <code class="docutils literal notranslate"><span class="pre">bpd.util.compare_frames()</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bpd</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">compare_frames</span><span class="p">(</span>
    <span class="n">bdf</span><span class="p">,</span> <span class="n">bdf</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">bdf</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span><span class="p">],</span>
    <span class="n">size_variable</span><span class="o">=</span><span class="s1">&#39;len&#39;</span><span class="p">,</span> <span class="n">operator</span><span class="o">=</span><span class="s1">&#39;geq&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
True
</pre></div></div>
</div>
</section>
<section id="Fill-in-missing-periods-as-unemployed">
<h2>Fill in missing periods as unemployed<a class="headerlink" href="#Fill-in-missing-periods-as-unemployed" title="Permalink to this heading"></a></h2>
<p>The method <code class="docutils literal notranslate"><span class="pre">.fill_missing_periods()</span></code> (for <em>Long</em> format) will fill in rows for missing intermediate periods.</p>
<div class="admonition note">
<p class="admonition-title fa fa-exclamation-circle">Hint</p>
<p>Filling in missing periods is a useful way to make sure that <code class="docutils literal notranslate"><span class="pre">.collapse()</span></code> only collapses over worker-firm spells if they are for categorical periods.</p>
</div>
<p>In this example, we drop periods 1-3, then fill them in, setting <code class="docutils literal notranslate"><span class="pre">k</span></code> (firm type) to become <span class="math notranslate nohighlight">\(-1\)</span> and <code class="docutils literal notranslate"><span class="pre">l</span></code> (worker type) to become its previous value:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bdf_missing</span> <span class="o">=</span> <span class="n">bdf</span><span class="p">[</span>
    <span class="p">(</span><span class="n">bdf</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">bdf</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span>
<span class="p">]</span><span class="o">.</span><span class="n">clean</span><span class="p">()</span>
<span class="n">bdf_fill_missing</span> <span class="o">=</span> <span class="n">bdf_missing</span><span class="o">.</span><span class="n">fill_missing_periods</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s1">&#39;k&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
        <span class="s1">&#39;l&#39;</span><span class="p">:</span> <span class="s1">&#39;prev&#39;</span>
    <span class="p">}</span>
<span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">bdf_fill_missing</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
checking required columns and datatypes
sorting rows
dropping NaN observations
generating &#39;m&#39; column
keeping highest paying job for i-t (worker-year) duplicates (how=&#39;max&#39;)
dropping workers who leave a firm then return to it (how=False)
making &#39;i&#39; ids contiguous
making &#39;j&#39; ids contiguous
making &#39;alpha&#39; ids contiguous
computing largest connected set (how=None)
sorting columns
resetting index
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>i</th>
      <th>j</th>
      <th>y</th>
      <th>t</th>
      <th>m</th>
      <th>alpha</th>
      <th>k</th>
      <th>l</th>
      <th>psi</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>66</td>
      <td>-0.884222</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>-0.348756</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>-1</td>
      <td>&lt;NA&gt;</td>
      <td>1</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>-1</td>
      <td>0</td>
      <td>&lt;NA&gt;</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>-1</td>
      <td>&lt;NA&gt;</td>
      <td>2</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>-1</td>
      <td>0</td>
      <td>&lt;NA&gt;</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>-1</td>
      <td>&lt;NA&gt;</td>
      <td>3</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>-1</td>
      <td>0</td>
      <td>&lt;NA&gt;</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>6</td>
      <td>-1.19054</td>
      <td>4</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>-1.335178</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>49995</th>
      <td>9999</td>
      <td>146</td>
      <td>0.5052</td>
      <td>0</td>
      <td>1</td>
      <td>3</td>
      <td>7</td>
      <td>2</td>
      <td>0.604585</td>
    </tr>
    <tr>
      <th>49996</th>
      <td>9999</td>
      <td>-1</td>
      <td>&lt;NA&gt;</td>
      <td>1</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>-1</td>
      <td>2</td>
      <td>&lt;NA&gt;</td>
    </tr>
    <tr>
      <th>49997</th>
      <td>9999</td>
      <td>-1</td>
      <td>&lt;NA&gt;</td>
      <td>2</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>-1</td>
      <td>2</td>
      <td>&lt;NA&gt;</td>
    </tr>
    <tr>
      <th>49998</th>
      <td>9999</td>
      <td>-1</td>
      <td>&lt;NA&gt;</td>
      <td>3</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>-1</td>
      <td>2</td>
      <td>&lt;NA&gt;</td>
    </tr>
    <tr>
      <th>49999</th>
      <td>9999</td>
      <td>114</td>
      <td>-0.610246</td>
      <td>4</td>
      <td>1</td>
      <td>3</td>
      <td>5</td>
      <td>2</td>
      <td>0.114185</td>
    </tr>
  </tbody>
</table>
<p>50000 rows × 9 columns</p>
</div></div>
</div>
</section>
<section id="Extended-event-studies">
<h2>Extended event studies<a class="headerlink" href="#Extended-event-studies" title="Permalink to this heading"></a></h2>
<p>BipartitePandas allows you to use <em>Long</em> format data to generate event studies with more than 2 periods.</p>
<p>You can specify:</p>
<ul class="simple">
<li><p>which column signals a transition (e.g. if <code class="docutils literal notranslate"><span class="pre">j</span></code> is used, a transition is when a worker moves firms)</p></li>
<li><p>which column(s) should be treated as the event study outcome</p></li>
<li><p>how many periods before and after the transition should be considered</p></li>
<li><p>whether the pre- and/or post-trends must be stable, and for which column(s)</p></li>
</ul>
<p>We consider an example where <code class="docutils literal notranslate"><span class="pre">j</span></code> is the transition column, <code class="docutils literal notranslate"><span class="pre">y</span></code> is the outcome column, and with pre- and post-trends of length 2 that are required to be at the same firm. Note that <code class="docutils literal notranslate"><span class="pre">y_f1</span></code> is the first observation after the individual moves firms.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">es_extended</span> <span class="o">=</span> <span class="n">bdf</span><span class="o">.</span><span class="n">get_extended_eventstudy</span><span class="p">(</span>
    <span class="n">transition_col</span><span class="o">=</span><span class="s1">&#39;j&#39;</span><span class="p">,</span> <span class="n">outcomes</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span>
    <span class="n">periods_pre</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">periods_post</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">stable_pre</span><span class="o">=</span><span class="s1">&#39;j&#39;</span><span class="p">,</span> <span class="n">stable_post</span><span class="o">=</span><span class="s1">&#39;j&#39;</span>
<span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">es_extended</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>i</th>
      <th>t</th>
      <th>y_l2</th>
      <th>y_l1</th>
      <th>y_f1</th>
      <th>y_f2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>7</td>
      <td>2</td>
      <td>2.660179</td>
      <td>1.376463</td>
      <td>1.965843</td>
      <td>2.006426</td>
    </tr>
    <tr>
      <th>1</th>
      <td>15</td>
      <td>2</td>
      <td>1.033709</td>
      <td>1.605745</td>
      <td>2.222907</td>
      <td>1.576384</td>
    </tr>
    <tr>
      <th>2</th>
      <td>28</td>
      <td>3</td>
      <td>0.814740</td>
      <td>2.291087</td>
      <td>2.511761</td>
      <td>1.557221</td>
    </tr>
    <tr>
      <th>3</th>
      <td>33</td>
      <td>3</td>
      <td>2.097549</td>
      <td>0.334050</td>
      <td>0.727795</td>
      <td>0.578112</td>
    </tr>
    <tr>
      <th>4</th>
      <td>35</td>
      <td>2</td>
      <td>-2.503758</td>
      <td>-0.281162</td>
      <td>0.201840</td>
      <td>0.086961</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2543</th>
      <td>9988</td>
      <td>2</td>
      <td>0.062628</td>
      <td>-0.286134</td>
      <td>-0.183206</td>
      <td>-1.367690</td>
    </tr>
    <tr>
      <th>2544</th>
      <td>9991</td>
      <td>3</td>
      <td>-3.105353</td>
      <td>0.688329</td>
      <td>0.432237</td>
      <td>-0.346683</td>
    </tr>
    <tr>
      <th>2545</th>
      <td>9994</td>
      <td>2</td>
      <td>-0.650689</td>
      <td>-3.249975</td>
      <td>-2.090252</td>
      <td>-2.282304</td>
    </tr>
    <tr>
      <th>2546</th>
      <td>9995</td>
      <td>2</td>
      <td>0.597124</td>
      <td>-0.159967</td>
      <td>1.380550</td>
      <td>2.604956</td>
    </tr>
    <tr>
      <th>2547</th>
      <td>9996</td>
      <td>2</td>
      <td>-0.621562</td>
      <td>-0.356489</td>
      <td>-2.629698</td>
      <td>-1.638295</td>
    </tr>
  </tbody>
</table>
<p>2548 rows × 6 columns</p>
</div></div>
</div>
</section>
<section id="Advanced-data-simulation">
<h2>Advanced data simulation<a class="headerlink" href="#Advanced-data-simulation" title="Permalink to this heading"></a></h2>
<p>For details on all simulation parameters, run <code class="docutils literal notranslate"><span class="pre">bpd.sim_params().describe_all()</span></code>, or search through <code class="docutils literal notranslate"><span class="pre">bpd.sim_params().keys()</span></code> for a particular key, and then run <code class="docutils literal notranslate"><span class="pre">bpd.sim_params().describe(key)</span></code>.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="connected_sets.html" class="btn btn-neutral float-left" title="Connected sets" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../internal.html" class="btn btn-neutral float-right" title="Python API" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Thibaut Lamadon.
      <span class="lastupdated">Last updated on Jul 24, 2023.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>